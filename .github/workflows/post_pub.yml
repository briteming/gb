name: Post Publish

permissions:
  actions: write

on:
  issues:
    types:
      - milestoned

jobs:
  post_publish:
    name: Post Publish
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4.1.1
      - uses: actions/setup-node@v3
      - name: Issue To Post
        env:
          ISSUE_DATA: ${{ toJson(github.event.issue) }}
        run: |
          npm install
          node .github/workflows/post_pub/issue_to_post.js "${ISSUE_DATA}"
          git config user.name 'github-actions[bot]'
          git config user.email 'github-actions[bot]@users.noreply.github.com'
          git add .
          git commit -m "Publish ${{github.event.issue.title}}"
          git push -f origin HEAD
